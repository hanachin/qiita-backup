[{"rendered_body":"\u003cp\u003e省略可能な引数のデフォルト値に\u003ccode\u003enil\u003c/code\u003eを使うと、引数に\u003ccode\u003enil\u003c/code\u003eを渡したのかデフォルト値の\u003ccode\u003enil\u003c/code\u003eが使われたのか分かりません。\u003cbr\u003e\n例えば以下のような問題がおきます\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eOkinawaSobaRestaurant\u003c/span\u003e\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"err\"\u003e沖縄そば\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"err\"\u003eフーチバー\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kp\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"err\"\u003eフーチバー\u003c/span\u003e\n      \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"沖縄そば、フーチーバーは\u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"err\"\u003eフーチバー\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n      \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"沖縄そば、フーチーバーはサービス\"\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"err\"\u003eすばやー\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eOkinawaSobaRestaurant\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# フーチバーの気分じゃないとき、なしにしてほしいのにサービスされてしまう\u003c/span\u003e\n\u003cspan class=\"err\"\u003eすばやー\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e沖縄そば\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"err\"\u003eフーチバー\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kp\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e# 沖縄そば、フーチーバーはサービス\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこういうときはデフォルト値に\u003ccode\u003enil\u003c/code\u003eのような一般的な値を使わず、デフォルト値の役割に応じた名前で定数を宣言すると便利です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eOkinawaSobaRestaurant\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e# nilと区別できるよう、デフォルト値用の値を用意しておく\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e# 引数で渡される値と被らないようにオブジェクトのインスタンスを作り定数として保持する\u003c/span\u003e\n  \u003cspan class=\"no\"\u003eGIVE_FUCHIBA\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e# だが、このメソッド以外からは使われてほしくないので、privateな定数に変更する\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eprivate_constant\u003c/span\u003e \u003cspan class=\"ss\"\u003e:GIVE_FUCHIBA\u003c/span\u003e\n\n  \u003cspan class=\"c1\"\u003e# デフォルトではフーチバーをサービスする\u003c/span\u003e\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"err\"\u003e沖縄そば\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"err\"\u003eフーチバー\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003eGIVE_FUCHIBA\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"err\"\u003eフーチバー\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ewhen\u003c/span\u003e \u003cspan class=\"no\"\u003eGIVE_FUCHIBA\u003c/span\u003e\n      \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"沖縄そば、フーチーバーはサービス\"\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ewhen\u003c/span\u003e \u003cspan class=\"kp\"\u003enil\u003c/span\u003e\n      \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"沖縄そば、フーチーバーはなし\"\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n      \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"沖縄そば、フーチーバーは\u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"err\"\u003eフーチバー\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"err\"\u003eすばやー\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eOkinawaSobaRestaurant\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# フーチバーの気分じゃないとき\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"err\"\u003eすばやー\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e沖縄そば\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"err\"\u003eフーチバー\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kp\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e# 沖縄そば、フーチーバーはなし\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# とにかくそばが食べたいとき\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"err\"\u003eすばやー\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e沖縄そば\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e# 沖縄そば、フーチーバーはサービス\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# フーチバー食べるためにそば食べたいとき\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"err\"\u003eすばやー\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e沖縄そば\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"err\"\u003eフーチバー\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"err\"\u003e山盛り\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e# 沖縄そば、フーチーバーは山盛り\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eデフォルト値と\u003ccode\u003enil\u003c/code\u003eを区別できるようになったので、ふーちばーどうでもいい(デフォルト値)、ふーちばーが食べたくない(\u003ccode\u003enil\u003c/code\u003e)、ふーちばー食べたいを表現出来るようになりました。べんりですね。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"参考\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://github.com/rails/rails/pull/24519/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://github.com/rails/rails/pull/24519/\u003c/a\u003e\u003c/p\u003e\n","body":"省略可能な引数のデフォルト値に`nil`を使うと、引数に`nil`を渡したのかデフォルト値の`nil`が使われたのか分かりません。\n例えば以下のような問題がおきます\n\n```rb\nclass OkinawaSobaRestaurant\n  def 沖縄そば(フーチバー: nil)\n    if フーチバー\n      puts \"沖縄そば、フーチーバーは#{フーチバー}\"\n    else\n      puts \"沖縄そば、フーチーバーはサービス\"\n    end\n  end\nend\n\nすばやー = OkinawaSobaRestaurant.new\n\n# フーチバーの気分じゃないとき、なしにしてほしいのにサービスされてしまう\nすばやー.沖縄そば(フーチバー: nil)\n# 沖縄そば、フーチーバーはサービス\n```\n\nこういうときはデフォルト値に`nil`のような一般的な値を使わず、デフォルト値の役割に応じた名前で定数を宣言すると便利です。\n\n```rb\nclass OkinawaSobaRestaurant\n  # nilと区別できるよう、デフォルト値用の値を用意しておく\n  # 引数で渡される値と被らないようにオブジェクトのインスタンスを作り定数として保持する\n  GIVE_FUCHIBA = Object.new\n  # だが、このメソッド以外からは使われてほしくないので、privateな定数に変更する\n  private_constant :GIVE_FUCHIBA\n\n  # デフォルトではフーチバーをサービスする\n  def 沖縄そば(フーチバー: GIVE_FUCHIBA)\n    case フーチバー\n    when GIVE_FUCHIBA\n      puts \"沖縄そば、フーチーバーはサービス\"\n    when nil\n      puts \"沖縄そば、フーチーバーはなし\"\n    else\n      puts \"沖縄そば、フーチーバーは#{フーチバー}\"\n    end\n  end\nend\n\nすばやー = OkinawaSobaRestaurant.new\n\n# フーチバーの気分じゃないとき\nputs すばやー.沖縄そば(フーチバー: nil)\n# 沖縄そば、フーチーバーはなし\n\n# とにかくそばが食べたいとき\nputs すばやー.沖縄そば\n# 沖縄そば、フーチーバーはサービス\n\n# フーチバー食べるためにそば食べたいとき\nputs すばやー.沖縄そば(フーチバー: :山盛り)\n# 沖縄そば、フーチーバーは山盛り\n```\n\nデフォルト値と`nil`を区別できるようになったので、ふーちばーどうでもいい(デフォルト値)、ふーちばーが食べたくない(`nil`)、ふーちばー食べたいを表現出来るようになりました。べんりですね。\n\n## 参考\nhttps://github.com/rails/rails/pull/24519/\n","coediting":false,"comments_count":0,"created_at":"2016-06-19T01:23:47+09:00","group":null,"id":"94f44ae6664a5665c8e8","likes_count":2,"private":false,"reactions_count":0,"tags":[{"name":"Ruby","versions":[]}],"title":"省略可能な引数でnilが渡されたのかデフォルト値が使われたのか区別するやり方","updated_at":"2016-06-19T01:27:08+09:00","url":"https://qiita.com/hanachin_/items/94f44ae6664a5665c8e8","user":{"description":"既婚バイ","facebook_id":"seiei.higa","followees_count":166,"followers_count":120,"github_login_name":"hanachin","id":"hanachin_","items_count":55,"linkedin_id":"","location":"Naha, Okinawa, Japan","name":"Seiei Miyagi","organization":"YassLab","permanent_id":2074,"profile_image_url":"https://qiita-image-store.s3.amazonaws.com/0/2074/profile-images/1511092027","twitter_screen_name":"hanachin_","website_url":""},"page_views_count":null}]