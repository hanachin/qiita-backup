[{"rendered_body":"\u003cp\u003eRefinementsを使うと他から参照できないrakeタスクの中だけで使えるメソッドを定義できる。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eRakefile\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003etop_level\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eself\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eusing\u003c/span\u003e \u003cspan class=\"no\"\u003eModule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"n\"\u003erefine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etop_level\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esingleton_class\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ehi\u003c/span\u003e\n      \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"ss\"\u003e:hi\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003edesc\u003c/span\u003e \u003cspan class=\"s1\"\u003e'はい'\u003c/span\u003e\n\u003cspan class=\"n\"\u003etask\u003c/span\u003e \u003cspan class=\"ss\"\u003e:hi\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ehi\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e% rake hi\nhi\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"その他のアプローチ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%9D%E3%81%AE%E4%BB%96%E3%81%AE%E3%82%A2%E3%83%97%E3%83%AD%E3%83%BC%E3%83%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eその他のアプローチ\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita.com/kuboon/items/26e90800856863c64cdc\" id=\"reference-654f5e6369c41e164108\"\u003erake task でメソッド定義 by @kuboon on @Qiita\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://ja.stackoverflow.com/questions/8223/%E7%89%B9%E5%AE%9A%E3%81%AErake%E3%82%BF%E3%82%B9%E3%82%AF%E5%86%85%E3%81%A7%E3%81%AE%E3%81%BF%E4%BD%BF%E3%81%86%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%81%AE%E5%AE%9A%E7%BE%A9%E6%96%B9%E6%B3%95\" rel=\"nofollow noopener\" target=\"_blank\"\u003eruby - 特定のRakeタスク内でのみ使うメソッドの定義方法 - スタック・オーバーフロー\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ふつうに定義したときの失敗1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%B5%E3%81%A4%E3%81%86%E3%81%AB%E5%AE%9A%E7%BE%A9%E3%81%97%E3%81%9F%E3%81%A8%E3%81%8D%E3%81%AE%E5%A4%B1%E6%95%971\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eふつうに定義したときの失敗1\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003ehi\u003c/code\u003eメソッドがトップレベルに定義されてしまう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eRakefile\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ehi\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"ss\"\u003e:hi\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003edesc\u003c/span\u003e \u003cspan class=\"s1\"\u003e'はい'\u003c/span\u003e\n\u003cspan class=\"n\"\u003etask\u003c/span\u003e \u003cspan class=\"ss\"\u003e:hi\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ehi\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ふつうに定義したときの失敗2\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%B5%E3%81%A4%E3%81%86%E3%81%AB%E5%AE%9A%E7%BE%A9%E3%81%97%E3%81%9F%E3%81%A8%E3%81%8D%E3%81%AE%E5%A4%B1%E6%95%972\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eふつうに定義したときの失敗2\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003ehi\u003c/code\u003eメソッドがトップレベルに定義されてしまう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eRakefile\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003edesc\u003c/span\u003e \u003cspan class=\"s1\"\u003e'はい'\u003c/span\u003e\n\u003cspan class=\"n\"\u003etask\u003c/span\u003e \u003cspan class=\"ss\"\u003e:hi\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ehi\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"ss\"\u003e:hi\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003ehi\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ふつうに定義したときの失敗3\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%B5%E3%81%A4%E3%81%86%E3%81%AB%E5%AE%9A%E7%BE%A9%E3%81%97%E3%81%9F%E3%81%A8%E3%81%8D%E3%81%AE%E5%A4%B1%E6%95%973\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eふつうに定義したときの失敗3\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003ehi\u003c/code\u003eメソッドがトップレベルに定義されてしまう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eRakefile\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003em\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eModule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ehi\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"ss\"\u003e:hi\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003edesc\u003c/span\u003e \u003cspan class=\"s1\"\u003e'はい'\u003c/span\u003e\n\u003cspan class=\"n\"\u003etask\u003c/span\u003e \u003cspan class=\"ss\"\u003e:hi\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003einclude\u003c/span\u003e \u003cspan class=\"n\"\u003em\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ehi\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n","body":"Refinementsを使うと他から参照できないrakeタスクの中だけで使えるメソッドを定義できる。\n\n```rb:Rakefile\ntop_level = self\n\nusing Module.new {\n  refine(top_level.singleton_class) do\n    def hi\n      puts :hi\n    end\n  end\n}\n\ndesc 'はい'\ntask :hi do\n  hi\nend\n```\n\n```\n% rake hi\nhi\n```\n\n## その他のアプローチ\n\n[rake task でメソッド定義 by @kuboon on @Qiita](https://qiita.com/kuboon/items/26e90800856863c64cdc)\n[ruby - 特定のRakeタスク内でのみ使うメソッドの定義方法 - スタック・オーバーフロー](https://ja.stackoverflow.com/questions/8223/%E7%89%B9%E5%AE%9A%E3%81%AErake%E3%82%BF%E3%82%B9%E3%82%AF%E5%86%85%E3%81%A7%E3%81%AE%E3%81%BF%E4%BD%BF%E3%81%86%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%81%AE%E5%AE%9A%E7%BE%A9%E6%96%B9%E6%B3%95)\n\n## ふつうに定義したときの失敗1\n\n`hi`メソッドがトップレベルに定義されてしまう。\n\n```rb:Rakefile\ndef hi\n  puts :hi\nend\n\ndesc 'はい'\ntask :hi do\n  hi\nend\n```\n\n## ふつうに定義したときの失敗2\n\n`hi`メソッドがトップレベルに定義されてしまう。\n\n```rb:Rakefile\ndesc 'はい'\ntask :hi do\n  def hi\n    puts :hi\n  end\n\n  hi\nend\n```\n\n## ふつうに定義したときの失敗3\n\n`hi`メソッドがトップレベルに定義されてしまう。\n\n```rb:Rakefile\nm = Module.new do\n  def hi\n    puts :hi\n  end\nend\n\ndesc 'はい'\ntask :hi do\n  include m\n  hi\nend\n```\n","coediting":false,"comments_count":2,"created_at":"2017-10-17T17:06:50+09:00","group":null,"id":"6cf63dd3987a60e3d264","likes_count":38,"private":false,"reactions_count":0,"tags":[{"name":"Ruby","versions":[]},{"name":"rake","versions":[]}],"title":"rakeタスクの中だけで使うメソッドはRefinementsで定義するとべんり","updated_at":"2017-10-17T18:12:14+09:00","url":"https://qiita.com/hanachin_/items/6cf63dd3987a60e3d264","user":{"description":"既婚バイ","facebook_id":"seiei.higa","followees_count":166,"followers_count":120,"github_login_name":"hanachin","id":"hanachin_","items_count":55,"linkedin_id":"","location":"Naha, Okinawa, Japan","name":"Seiei Miyagi","organization":"YassLab","permanent_id":2074,"profile_image_url":"https://qiita-image-store.s3.amazonaws.com/0/2074/profile-images/1511092027","twitter_screen_name":"hanachin_","website_url":""},"page_views_count":null}]